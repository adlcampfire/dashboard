{% extends "base.html" %}

{% block title %}Global Timeline - {{ site_settings.site_name }}{% endblock %}

{% block content %}
<div class="dashboard-header">
    <h1>Global Timeline üåç</h1>
    <p>See what all teams are working on</p>
</div>

<div class="timeline">
    {% if posts %}
        {% for post in posts %}
            {% include 'components/post_card.html' %}
        {% endfor %}
    {% else %}
        <div class="empty-state">
            <p>No global posts yet. Be the first to share with everyone!</p>
            <a href="{{ url_for('create_post') }}" class="btn btn-primary">Create First Global Post</a>
        </div>
    {% endif %}
</div>

<!-- Image Lightbox -->
<div id="lightbox" class="lightbox" onclick="closeLightbox()" style="display: none;">
    <span class="lightbox-close">&times;</span>
    <img class="lightbox-content" id="lightbox-image">
</div>
{% endblock %}

{% block extra_js %}
<script>
function openLightbox(src) {
    document.getElementById('lightbox').style.display = 'flex';
    document.getElementById('lightbox-image').src = src;
}

function closeLightbox() {
    document.getElementById('lightbox').style.display = 'none';
}

function reportPost(postId) {
    if (confirm('Report this post as inappropriate?')) {
        fetch('/api/report/post/' + postId, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCsrfToken()
            },
            body: JSON.stringify({
                reason: 'inappropriate',
                details: ''
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                showToast('Report submitted successfully', 'success');
            } else {
                showToast('Failed to submit report', 'error');
            }
        });
    }
}
</script>
{% endblock %}
